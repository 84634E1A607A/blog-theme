!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Nlvi=e()}(this,function(){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function e(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}var u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function a(t,e){function n(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function l(t){return"function"==typeof t}var n=!1,h={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t);n=t},get useDeprecatedSynchronousErrorHandling(){return n}};function f(t){setTimeout(function(){throw t})}var p={closed:!0,next:function(t){},error:function(t){if(h.useDeprecatedSynchronousErrorHandling)throw t;f(t)},complete:function(){}},d=Array.isArray||function(t){return t&&"number"==typeof t.length};function b(t){return null!=t&&"object"==typeof t}var y,v={e:{}};function _(){try{return y.apply(this,arguments)}catch(t){return v.e=t,v}}function m(t){return y=t,_}function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}t.prototype=Object.create(Error.prototype);var g=t,w=function(){function r(t){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}var t;return r.prototype.unsubscribe=function(){var t,e=!1;if(!this.closed){var n=this._parent,r=this._parents,i=this._unsubscribe,o=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var s=-1,c=r?r.length:0;n;)n.remove(this),n=++s<c&&r[s]||null;if(l(i))m(i).call(this)===v&&(e=!0,t=t||(v.e instanceof g?E(v.e.errors):[v.e]));if(d(o))for(s=-1,c=o.length;++s<c;){var u=o[s];if(b(u))if(m(u.unsubscribe).call(u)===v){e=!0,t=t||[];var a=v.e;a instanceof g?t=t.concat(E(a.errors)):t.push(a)}}if(e)throw new g(t)}},r.prototype.add=function(t){if(!t||t===r.EMPTY)return r.EMPTY;if(t===this)return this;var e=t;switch(typeof t){case"function":e=new r(t);case"object":if(e.closed||"function"!=typeof e.unsubscribe)return e;if(this.closed)return e.unsubscribe(),e;if("function"!=typeof e._addParent){var n=e;(e=new r)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(e),e._addParent(this),e},r.prototype.remove=function(t){var e=this._subscriptions;if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}},r.prototype._addParent=function(t){var e=this._parent,n=this._parents;e&&e!==t?n?-1===n.indexOf(t)&&n.push(t):this._parents=[t]:this._parent=t},r.EMPTY=((t=new r).closed=!0,t),r}();function E(t){return t.reduce(function(t,e){return t.concat(e instanceof g?e.errors:e)},[])}var S="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),x=function(i){function o(t,e,n){var r=i.call(this)||this;switch(r.syncErrorValue=null,r.syncErrorThrown=!1,r.syncErrorThrowable=!1,r.isStopped=!1,r._parentSubscription=null,arguments.length){case 0:r.destination=p;break;case 1:if(!t){r.destination=p;break}if("object"==typeof t){t instanceof o?(r.syncErrorThrowable=t.syncErrorThrowable,(r.destination=t).add(r)):(r.syncErrorThrowable=!0,r.destination=new T(r,t));break}default:r.syncErrorThrowable=!0,r.destination=new T(r,t,e,n)}return r}return a(o,i),o.prototype[S]=function(){return this},o.create=function(t,e,n){var r=new o(t,e,n);return r.syncErrorThrowable=!1,r},o.prototype.next=function(t){this.isStopped||this._next(t)},o.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},o.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},o.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,i.prototype.unsubscribe.call(this))},o.prototype._next=function(t){this.destination.next(t)},o.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},o.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},o.prototype._unsubscribeAndRecycle=function(){var t=this._parent,e=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=e,this._parentSubscription=null,this},o}(w),T=function(c){function t(t,e,n,r){var i,o=c.call(this)||this;o._parentSubscriber=t;var s=o;return l(e)?i=e:e&&(i=e.next,n=e.error,r=e.complete,e!==p&&(l((s=Object.create(e)).unsubscribe)&&o.add(s.unsubscribe.bind(s)),s.unsubscribe=o.unsubscribe.bind(o))),o._context=s,o._next=i,o._error=n,o._complete=r,o}return a(t,c),t.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;h.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},t.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,n=h.useDeprecatedSynchronousErrorHandling;if(this._error)n&&e.syncErrorThrowable?this.__tryOrSetError(e,this._error,t):this.__tryOrUnsub(this._error,t),this.unsubscribe();else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):f(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;f(t)}}},t.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var n=function(){return t._complete.call(t._context)};h.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,n):this.__tryOrUnsub(n),this.unsubscribe()}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),h.useDeprecatedSynchronousErrorHandling)throw t;f(t)}},t.prototype.__tryOrSetError=function(e,t,n){if(!h.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(t){return h.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0):(f(t),!0)}return!1},t.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},t}(x);var k="function"==typeof Symbol&&Symbol.observable||"@@observable";function O(){}var j=function(){function n(t){this._isScalar=!1,t&&(this._subscribe=t)}return n.prototype.lift=function(t){var e=new n;return e.source=this,e.operator=t,e},n.prototype.subscribe=function(t,e,n){var r=this.operator,i=function(t,e,n){if(t){if(t instanceof x)return t;if(t[S])return t[S]()}return t||e||n?new x(t,e,n):new x(p)}(t,e,n);if(r?r.call(i,this.source):i.add(this.source||h.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),h.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},n.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){h.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),!function(t){for(;t;){var e=t.destination;if(t.closed||t.isStopped)return!1;t=e&&e instanceof x?e:null}return!0}(e)?console.warn(t):e.error(t)}},n.prototype.forEach=function(r,t){var i=this;return new(t=A(t))(function(t,e){var n;n=i.subscribe(function(t){try{r(t)}catch(t){e(t),n&&n.unsubscribe()}},e,t)})},n.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},n.prototype[k]=function(){return this},n.prototype.pipe=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return 0===t.length?this:((e=t)?1===e.length?e[0]:function(t){return e.reduce(function(t,e){return e(t)},t)}:O)(this)},n.prototype.toPromise=function(t){var r=this;return new(t=A(t))(function(t,e){var n;r.subscribe(function(t){return n=t},function(t){return e(t)},function(){return t(n)})})},n.create=function(t){return new n(t)},n}();function A(t){if(t||(t=h.Promise||Promise),!t)throw new Error("no Promise impl found");return t}function P(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}P.prototype=Object.create(Error.prototype);var C=function(r){function t(t,e){var n=r.call(this,t,e)||this;return n.scheduler=t,n.work=e,n.pending=!1,n}return a(t,r),t.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this},t.prototype.requestAsyncId=function(t,e,n){return void 0===n&&(n=0),setInterval(t.flush.bind(t,this),n)},t.prototype.recycleAsyncId=function(t,e,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)},t.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(t,e){var n=!1,r=void 0;try{this.work(t)}catch(t){n=!0,r=!!t&&t||new Error(t)}if(n)return this.unsubscribe(),r},t.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},t}(function(n){function t(t,e){return n.call(this)||this}return a(t,n),t.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},t}(w)),D=function(){function n(t,e){void 0===e&&(e=n.now),this.SchedulerAction=t,this.now=e}return n.prototype.schedule=function(t,e,n){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(n,e)},n.now=function(){return Date.now()},n}(),V=function(r){function i(t,e){void 0===e&&(e=D.now);var n=r.call(this,t,function(){return i.delegate&&i.delegate!==n?i.delegate.now():e()})||this;return n.actions=[],n.active=!1,n.scheduled=void 0,n}return a(i,r),i.prototype.schedule=function(t,e,n){return void 0===e&&(e=0),i.delegate&&i.delegate!==this?i.delegate.schedule(t,e,n):r.prototype.schedule.call(this,t,e,n)},i.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}},i}(D);var H=new V(C);function I(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}I.prototype=Object.create(Error.prototype);function L(e,n){return function(t){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return t.lift(new U(e,n))}}var U=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new M(t,this.project,this.thisArg))},t}(),M=function(i){function t(t,e,n){var r=i.call(this,t)||this;return r.project=e,r.count=0,r.thisArg=n||r,r}return a(t,i),t.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},t}(x);function q(t,n,r,e){return l(r)&&(e=r,r=void 0),e?q(t,n,r).pipe(L(function(t){return d(t)?e.apply(void 0,t):e(t)})):new j(function(e){!function t(e,n,r,i,o){var s;if(d=e,d&&"function"==typeof d.addEventListener&&"function"==typeof d.removeEventListener){var c=e;e.addEventListener(n,r,o),s=function(){return c.removeEventListener(n,r,o)}}else if(p=e,p&&"function"==typeof p.on&&"function"==typeof p.off){var u=e;e.on(n,r),s=function(){return u.off(n,r)}}else if(f=e,f&&"function"==typeof f.addListener&&"function"==typeof f.removeListener){var a=e;e.addListener(n,r),s=function(){return a.removeListener(n,r)}}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(var l=0,h=e.length;l<h;l++)t(e[l],n,r,i,o)}var f;var p;var d;i.add(s)}(t,n,function(t){e.next(1<arguments.length?Array.prototype.slice.call(arguments):t)},e,r)})}var z={leading:!0,trailing:!1};var Y=function(){function t(t,e,n,r){this.duration=t,this.scheduler=e,this.leading=n,this.trailing=r}return t.prototype.call=function(t,e){return e.subscribe(new R(t,this.duration,this.scheduler,this.leading,this.trailing))},t}(),R=function(s){function t(t,e,n,r,i){var o=s.call(this,t)||this;return o.duration=e,o.scheduler=n,o.leading=r,o.trailing=i,o._hasTrailingValue=!1,o._trailingValue=null,o}return a(t,s),t.prototype._next=function(t){this.throttled?this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(N,this.duration,{subscriber:this})),this.leading&&this.destination.next(t))},t.prototype._complete=function(){this._hasTrailingValue&&this.destination.next(this._trailingValue),this.destination.complete()},t.prototype.clearThrottle=function(){var t=this.throttled;t&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),t.unsubscribe(),this.remove(t),this.throttled=null)},t}(x);function N(t){t.subscriber.clearThrottle()}var W=function(){function r(t){i(this,r),this.config=t,this.theme=t.theme,this.scrollArr=[]}return e(r,[{key:"init",value:function(){var e=this,n=r.utils,t={smoothScroll:function(){var t=this;$(".toc-link").on("click",function(){$("html, body").animate({scrollTop:$($.attr(t,"href")).offset().top-200})})},picPos:function(){$(".post-content").each(function(){$(this).find("img").each(function(){$(this).parent("p").css("text-align","center");var t="<img src='"+this.src;theme.lazy&&(t="<img class='lazy' data-src='"+this.src),$(this).replaceWith("<a href='"+this.src+"' data-title='"+this.alt+"' data-lightbox='group'>"+t+"' alt='"+this.alt+"'></a>")})})},showComments:function(){var t=this;$("#com-switch").on("click",function(){n("iss","#post-comments").display()?($("#post-comments").css("display","block").addClass("syuanpi fadeInDown"),$(t).removeClass("syuanpi").css("transform","rotate(180deg)")):($(t).addClass("syuanpi").css("transform",""),n("cls","#post-comments").opreate("fadeInDown","remove"),n("ani","#post-comments").end("fadeOutUp",function(){$(this).css("display","none")}))})}};return r.opScroll(this.scrollArr),Object.values(t).forEach(function(t){return t.call(e)})}},{key:"showToc",value:function(){var c=r.utils,u=$(".toc-link"),t=$(".headerlink");this.scrollArr.push(function(o){var s=$.map(t,function(t){return $(t).offset().top});$(".title-link a").each(function(){var t=c("cls",this);t.opreate("active",0<=o&&o<230?"add":"remove")}),u.forEach(function(t,e){var n=s[e],r=e+1===u.length?1/0:s[e+1],i=c("cls",u[e]);return i.opreate("active",n<o+200&&o+200<=r?"add":"remove")})})}},{key:"pjax",value:function(){}}],[{key:"utils",value:function(t,e){var r=function(n){return{opreate:function(t,e){return"remove"===e?$(n).removeClass(t):$(n).addClass(t)},exist:function(t){return $(n).hasClass(t)}}};return{cls:r,iss:function(t){return{banderole:function(){return"banderole"===this.theme.scheme},balance:function(){return"balance"===this.theme.scheme},display:function(){return"none"===$(t).css("display")}}},ani:function(n){return{close:function(){return r.opreate(".syuanpi","syuanpi","remove")},end:function(t,e){$(n).addClass(t).one("webkitAnimationEnd AnimationEnd",function(){$(n).removeClass(t),e.apply(n)})}}}}[t](e)}},{key:"opScroll",value:function(t){var e,n,r,i=q(window,"scroll").pipe((e=200,void 0===n&&(n=H),void 0===r&&(r=z),function(t){return t.lift(new Y(e,n,r.leading,r.trailing))}),L(function(t){return t.target.value}));t.length&&i.subscribe(console.log)}}]),r}();return function(t){function n(t){var e;return i(this,n),(e=c(this,o(n).call(this,t))).utils=W.utils,e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(n,W),e(n,[{key:"balance",value:function(){this.utils.back2top=function(){utils("cls","#backtop").opreate("melt","remove"),this.utils("win",window).scroll()(function(t){var e=Math.floor(t/($(document).height()-$(this).height())*100);$("#scrollpercent").html(e)}),$(".toTop").on("click",function(){$("html, body").animate({scrollTop:0})})}}},{key:"switchToc",value:function(){var e=this.utils,t=e("cls","#toc-switch"),n=e("ani",".toc-inner");function r(t){e("cls",".menu-item").opreate("has_toc",t),e("cls",".main-nav").opreate("has_toc",t)}e("cls","#toc-switch").opreate("not-toc"),$("#toc-switch").on("click",function(){t.exist("not-toc")?(t.opreate("not-toc","remove"),n.end("fadeInDown"),$(".toc-inner").show(),r()):(n.end("fadeOutUp",function(){$(".toc-inner").hide()}),t.opreate("not-toc"),r("remove"))})}},{key:"tagcloud",value:function(){$("#tags").on("click",function(){tool("existClass")("#tagcloud","show")?$("#tagcloud").addClass("melt").one("webkitAnimationEnd AnimationEnd",function(){$(this).hide(),tool("opreateClass")("#tagcloud","show syuanpi clarity melt","remove"),tool("opreateClass")(".menu-item","has_tag","remove"),tool("opreateClass")(".main-nav","has_tag","remove")}):($("#tagcloud").show(),tool("opreateClass")("#tagcloud","show syuanpi clarity"),tool("opreateClass")(".menu-item","has_tag"),tool("opreateClass")(".main-nav","has_tag"))}),$("#mobile-tags").on("click",function(){$(".inner-cloud").css("transform","translateX(-96%)")})}}]),n}()});
